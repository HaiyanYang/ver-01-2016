subroutine set_fnm_elems()                                 
use parameter_module,      only: DP                        
use elem_list_module,      only: layup, elem_list,&        
                      & elem_node_connec, elem_edge_connec 
use fBrickLam_elem_module, only: plyblock_layup, set       
                                                           
  integer :: nelem   = 0                                   
  integer :: elnnode = 0                                   
  integer :: elnedge = 0                                   
  integer :: nplyblk = 0                                   
  integer, allocatable :: nodecnc(:), edgecnc(:)           
                                                           
  nelem   =8                                
  elnnode =88                              
  elnedge =24                              
  nplyblk =3                                
  allocate(elem_list(nelem))                               
  allocate(elem_node_connec(elnnode,nelem))                
  allocate(elem_edge_connec(elnedge,nelem))                
  allocate(nodecnc(elnnode))                               
  allocate(edgecnc(elnedge))                               
  allocate(layup(nplyblk))                                 
  nodecnc = 0                                              
  edgecnc = 0                                              
                                                           
 layup(1)=plyblock_layup(angle=0._DP,nplies=1) 
 layup(2)=plyblock_layup(angle=60._DP,nplies=4) 
 layup(3)=plyblock_layup(angle=0._DP,nplies=1) 
                                                           

  nodecnc=[ &
& 18,27,14,1,20,28,13,2,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,136,145,132,119,138,146,131,120,149,150,151,152, &
& 153,154,155,156,157,158,159,160,161,162,163,164,254,263,250,237,256,264,249,238,267,268,269,270,271,272,273,274,275,276, &
& 277,278,279,280,281,282,355,356,357,358,359,360,361,362,399,400,401,402,403,404,405,406 &
& ]
  edgecnc=[ &
& 1,2,3,4,5,6,7,8,45,46,47,48,49,50,51,52,89,90,91,92,93,94,95,96 &
& ]
  call set(elem_list(1), NPLYBLKS=3)
  elem_node_connec(:,1)=nodecnc(:)
  elem_edge_connec(:,1)=edgecnc(:)


  nodecnc=[ &
& 27,17,4,14,28,19,3,13,47,48,49,50,51,52,34,33,53,54,55,56,57,58,42,41,145,135,122,132,146,137,121,131,165,166,167,168, &
& 169,170,152,151,171,172,173,174,175,176,160,159,263,253,240,250,264,255,239,249,283,284,285,286,287,288,270,269,289,290, &
& 291,292,293,294,278,277,363,364,365,356,366,367,368,360,407,408,409,400,410,411,412,404 &
& ]
  edgecnc=[ &
& 9,10,11,2,12,13,14,6,53,54,55,46,56,57,58,50,97,98,99,90,100,101,102,94 &
& ]
  call set(elem_list(2), NPLYBLKS=3)
  elem_node_connec(:,2)=nodecnc(:)
  elem_edge_connec(:,2)=edgecnc(:)


  nodecnc=[ &
& 8,16,27,18,5,15,28,20,59,60,61,62,32,31,63,64,65,66,67,68,40,39,69,70,126,134,145,136,123,133,146,138,177,178,179,180, &
& 150,149,181,182,183,184,185,186,158,157,187,188,244,252,263,254,241,251,264,256,295,296,297,298,268,267,299,300,301,302, &
& 303,304,276,275,305,306,369,370,355,371,372,373,359,374,413,414,399,415,416,417,403,418 &
& ]
  edgecnc=[ &
& 15,16,1,17,18,19,5,20,59,60,45,61,62,63,49,64,103,104,89,105,106,107,93,108 &
& ]
  call set(elem_list(3), NPLYBLKS=3)
  elem_node_connec(:,3)=nodecnc(:)
  elem_edge_connec(:,3)=edgecnc(:)


  nodecnc=[ &
& 16,7,17,27,15,6,19,28,71,72,73,74,48,47,62,61,75,76,77,78,54,53,68,67,134,125,135,145,133,124,137,146,189,190,191,192, &
& 166,165,180,179,193,194,195,196,172,171,186,185,252,243,253,263,251,242,255,264,307,308,309,310,284,283,298,297,311,312, &
& 313,314,290,289,304,303,375,376,363,370,377,378,366,373,419,420,407,414,421,422,410,417 &
& ]
  edgecnc=[ &
& 21,22,9,16,23,24,12,19,65,66,53,60,67,68,56,63,109,110,97,104,111,112,100,107 &
& ]
  call set(elem_list(4), NPLYBLKS=3)
  elem_node_connec(:,4)=nodecnc(:)
  elem_edge_connec(:,4)=edgecnc(:)


  nodecnc=[ &
& 23,30,22,12,24,29,21,9,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,141,148,140,130,142,147,139,127,197,198,199,200, &
& 201,202,203,204,205,206,207,208,209,210,211,212,259,266,258,248,260,265,257,245,315,316,317,318,319,320,321,322,323,324, &
& 325,326,327,328,329,330,379,380,381,382,383,384,385,386,423,424,425,426,427,428,429,430 &
& ]
  edgecnc=[ &
& 25,26,27,28,29,30,31,32,69,70,71,72,73,74,75,76,113,114,115,116,117,118,119,120 &
& ]
  call set(elem_list(5), NPLYBLKS=3)
  elem_node_connec(:,5)=nodecnc(:)
  elem_edge_connec(:,5)=edgecnc(:)


  nodecnc=[ &
& 30,25,11,22,29,26,10,21,95,96,97,98,99,100,82,81,101,102,103,104,105,106,90,89,148,143,129,140,147,144,128,139,213,214, &
& 215,216,217,218,200,199,219,220,221,222,223,224,208,207,266,261,247,258,265,262,246,257,331,332,333,334,335,336,318,317, &
& 337,338,339,340,341,342,326,325,387,388,389,380,390,391,392,384,431,432,433,424,434,435,436,428 &
& ]
  edgecnc=[ &
& 33,34,35,26,36,37,38,30,77,78,79,70,80,81,82,74,121,122,123,114,124,125,126,118 &
& ]
  call set(elem_list(6), NPLYBLKS=3)
  elem_node_connec(:,6)=nodecnc(:)
  elem_edge_connec(:,6)=edgecnc(:)


  nodecnc=[ &
& 8,18,30,23,5,20,29,24,64,63,107,108,80,79,109,110,70,69,111,112,88,87,113,114,126,136,148,141,123,138,147,142,182,181, &
& 225,226,198,197,227,228,188,187,229,230,206,205,231,232,244,254,266,259,241,256,265,260,300,299,343,344,316,315,345,346, &
& 306,305,347,348,324,323,349,350,371,393,379,394,374,395,383,396,415,437,423,438,418,439,427,440 &
& ]
  edgecnc=[ &
& 17,39,25,40,20,41,29,42,61,83,69,84,64,85,73,86,105,127,113,128,108,129,117,130 &
& ]
  call set(elem_list(7), NPLYBLKS=3)
  elem_node_connec(:,7)=nodecnc(:)
  elem_edge_connec(:,7)=edgecnc(:)


  nodecnc=[ &
& 18,1,25,30,20,2,26,29,38,37,115,116,96,95,108,107,46,45,117,118,102,101,112,111,136,119,143,148,138,120,144,147,156,155, &
& 233,234,214,213,226,225,164,163,235,236,220,219,230,229,254,237,261,266,256,238,262,265,274,273,351,352,332,331,344,343, &
& 282,281,353,354,338,337,348,347,358,397,387,393,362,398,390,395,402,441,431,437,406,442,434,439 &
& ]
  edgecnc=[ &
& 4,43,33,39,8,44,36,41,48,87,77,83,52,88,80,85,92,131,121,127,96,132,124,129 &
& ]
  call set(elem_list(8), NPLYBLKS=3)
  elem_node_connec(:,8)=nodecnc(:)
  elem_edge_connec(:,8)=edgecnc(:)

end subroutine set_fnm_elems
